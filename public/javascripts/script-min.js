var dropdownOpen=!1;$('.menu-div').click(function(){if(dropdownOpen){$('.custom-dropdown-menu').hide();dropdownOpen=!1}else{$('.custom-dropdown-menu').show();dropdownOpen=!0}});var baseString='Let\'s vote on ';var $splash=$('.splash-text');var baseCounter=1;var subjectCounter=1;var subjects=['sports.','ice-cream.','videogames.','action films.','jazz bands.','colours.','fashion.','literature.','paintings.','photography.','animals.','architecture.','telephones.','cartoons.','bicycles.','composers.','cars.','board-games.','planets.','sitcoms.','seafood.','kitchenware.','fireworks.','history.','gymnastics.','turntables.','fruits.','house-plants.','genres.','waterfalls.','fancy hats.','parkour.','weightlifting.','handwriting.','camping.','chocolate.','ghost stories.','hairstyles.','guitars.'];var newSubjectNeeded=!0;var subjectRemovalNeeded=!1;var currentSubject='';var recentSubjects=['','','','',''];var completedCounter=0;var stringInterval=setInterval(function(){if(baseCounter<=baseString.length){$splash.text(baseString.slice(0,baseCounter));baseCounter++}else{if(newSubjectNeeded){currentSubject=randomNewSubject();newSubjectNeeded=!1}
if(subjectRemovalNeeded){if($splash.text()!=='Let\'s vote on '){$splash.text(baseString+currentSubject.slice(0,subjectCounter));subjectCounter--}else{newSubjectNeeded=!0;subjectRemovalNeeded=!1;subjectCounter=0}}else{if(subjectCounter<=currentSubject.length){$splash.text(baseString+currentSubject.slice(0,subjectCounter));subjectCounter++}else{completedCounter++;if(completedCounter===3){subjectRemovalNeeded=!0;completedCounter=0;subjectCounter=-1}}}}},100);function randomNewSubject(){var generatedSubject=randomSubject();if(recentSubjects.indexOf(generatedSubject)>-1){return randomNewSubject()}else{recentSubjects.pop();recentSubjects.unshift(generatedSubject);return generatedSubject}
function randomSubject(){return subjects[Math.floor(Math.random()*subjects.length)]}}
var $creationForm=$('#creationForm');var $myPolls=$('#myPollList');$('#profileCreatePoll').click(function(){$creationForm.show();$myPolls.hide()});$('#profileMyPolls').click(function(){$creationForm.hide();$myPolls.show()});var $passBg=$('#passBg');var $passModal=$('#passModal');var $body=$('body');$('#passChange').click(function(){$('#passMessage').hide();$passBg.addClass('bg-active');$passModal.addClass('modal-active');$body.addClass('open-modal-body')});$('#closeModal').click(function(){$passBg.removeClass('bg-active');$passModal.removeClass('modal-active');$body.removeClass('open-modal-body')});$('#passChangeForm').submit(function(e){e.preventDefault();$.post($('#passChangeForm').attr('action'),$('#passChangeForm').serialize(),function(data){$('#passMessage').text(data).show();$passBg.removeClass('bg-active');$passModal.removeClass('modal-active');$body.removeClass('open-modal-body')})});var $delBg=$('#delBg');var $delModal=$('#delModal');var siblingLink;var pollId;$('#myPollList').on('click','button',function(e){siblingLink=e.target.previousSibling.href;pollId=siblingLink.slice(siblingLink.lastIndexOf('/')+1);$('#passMessage').hide();$delBg.addClass('bg-active');$delModal.addClass('modal-active');$body.addClass('open-modal-body')});$('#delPollCancel').click(function(){$delBg.removeClass('bg-active');$delModal.removeClass('modal-active');$body.removeClass('open-modal-body')});$('#delPollConfirm').click(function(){$.post('/delete/'+pollId,function(data){$('#passMessage').text(data).show();if(data==='Poll deleted!'){$('a[href="poll/'+pollId+'"]').next().remove();$('a[href="poll/'+pollId+'"]').replaceWith('<h2 class="deleted-poll">Poll deleted.</h2>')}
$delBg.removeClass('bg-active');$delModal.removeClass('modal-active');$body.removeClass('open-modal-body')})});var inputCounter=3;$('#addOption').click(function(){$('#optionGroup').append('<input class="custom-input form-control" placeholder="Add another option" id="pollOption'+inputCounter+'" type="text" name="pollOption'+inputCounter+'"></input>');inputCounter++});var optionNames=singleUser.polls[0].pollOptions.map(function(pollOption){return pollOption.optionName});var votes=singleUser.polls[0].pollOptions.map(function(pollOption){return pollOption.votes});var backgroundColours=optionNames.map(function(){return randomColour()});var ctx=$('#pollChart');var doughnutPoll=new Chart(ctx,{type:'doughnut',data:{labels:optionNames,datasets:[{data:votes,backgroundColor:backgroundColours}]}});function randomColour(){var hexChars=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"];var colour='#';for(var i=0;i<6;i++){colour+=hexChars[Math.floor(Math.random()*16)]}
return colour}
$('#voteForm').submit(function(e){var actionString=$('#voteForm').attr('action');var pollIdStart=actionString.lastIndexOf('/')+1;var pollIdEnd=actionString.indexOf('?');var pollId=actionString.slice(pollIdStart,pollIdEnd);if(localStorage[pollId]){e.preventDefault();$('#voteLimitMsg').show()}else{localStorage.setItem(pollId,'voted')}})